# Конвертер DOCX в TXT с анализом изображений

Скрипт для преобразования DOCX файлов в TXT формат с автоматическим анализом изображений через OpenRouter API.

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Убедитесь, что в файле `.env` указаны:
   - `LLM_TOKEN` - токен от OpenRouter
   - `VISION_MODEL` - модель для анализа изображений (по умолчанию: `google/gemini-2.0-flash-001`)

## Использование

Запустите скрипт:
```bash
python convert_docx_to_txt.py
```

Скрипт автоматически найдет все DOCX файлы в текущей директории и создаст соответствующие TXT файлы с сохранением правильной последовательности текста и изображений.

## Как это работает

1. Скрипт извлекает текст и изображения из DOCX файлов в правильном порядке
2. Для каждого изображения отправляется запрос в OpenRouter API с использованием указанной модели
3. Модель анализирует изображение и возвращает текстовое описание
4. Результат сохраняется в TXT файл с сохранением последовательности:
   - Текст из документа
   - Описание изображения (если есть)
   - Следующий текст
   - И т.д.

## Формат вывода

В TXT файле изображения будут представлены в следующем формате:

```
[ИЗОБРАЖЕНИЕ 1: image1.png]
Описание изображения от модели...

Текст после изображения...
```

## Примечания

- Обработка большого количества изображений может занять время
- Убедитесь, что у вас достаточно средств на балансе OpenRouter для обработки всех изображений
- Скрипт обрабатывает изображения последовательно, чтобы не перегружать API

