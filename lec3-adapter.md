# Лекция 3: Адаптеры для дообучения

## Что такое адаптер?

**Адаптер** — любой обучаемый модуль, который добавляется после обучения модели для адаптации к новому домену на небольшом наборе данных.

## Архитектура адаптера

**Структура:**
1. **Input** → **Layer Norm**
2. **Bottleneck FeedForward** (D → H, где D >> H)
3. **ReLU** активация
4. **Expansion FeedForward** (H → D, где D >> H)
5. **Residual connection** от Input к Output

**Принцип:** Узкое место (bottleneck) для уменьшения параметров, затем расширение обратно.

## Ограничения адаптеров

### Замороженные модули декодера

- Декодер заморожен для избежания забывания предыдущего обучения
- Не изучает семантику текста из новой области
- Может создавать трудности для некоторых моделей

### Замороженная токенизация/декодирование

- Невозможно изменить словарь/токенизатор декодера
- Текст новой области должен поддерживаться токенизатором исходной модели
- Адаптеры нельзя использовать для обучения на другом языке

### Риск переобучения

- Адаптеры работают на очень малых объёмах данных
- Легко переобучить и снизить производительность на исходном домене
- Требуются эксперименты и быстрый цикл итераций

## Преимущества

- Быстрое дообучение на малых данных
- Сохранение знаний исходной модели
- Эффективное использование вычислительных ресурсов

